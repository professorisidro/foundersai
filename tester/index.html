<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mini REST Client</title>
  <style>
    /* ---------- Tema (light/dark) via CSS Variables ---------- */
    :root {
      --bg: #0f1115;
      --panel: #161a22;
      --panel-2: #10131a;
      --text: #e5e7eb;
      --muted: #9aa4b2;
      --border: #2a3242;
      --accent: #3b82f6;
      --accent-2: #2563eb;
      --good: #22c55e;
      --bad: #ef4444;
      --warn: #f59e0b;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --input-bg: #0f1218;
      --code: #cbd5e1;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --radius: 14px;
    }
    [data-theme="light"] {
      --bg: #f6f7fb;
      --panel: #ffffff;
      --panel-2: #f2f4f8;
      --text: #0f172a;
      --muted: #475569;
      --border: #e5e7eb;
      --accent: #2563eb;
      --accent-2: #1d4ed8;
      --good: #16a34a;
      --bad: #dc2626;
      --warn: #d97706;
      --shadow: 0 10px 30px rgba(2,6,23,.08);
      --input-bg: #fff;
      --code: #0f172a;
    }

    html, body {
      height: 100%;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    .container {
      max-width: 1200px;
      margin: 32px auto;
      padding: 0 16px;
    }

    .card {
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    /* ---------- Header ---------- */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 16px 18px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.02), transparent);
    }
    .brand {
      display: flex; align-items: center; gap: 10px; font-weight: 700;
      letter-spacing: .2px;
    }
    .brand .dot {
      width: 12px; height: 12px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #93c5fd, #3b82f6);
      box-shadow: 0 0 0 4px rgba(59,130,246,.25);
    }
    .header-actions { display: flex; align-items: center; gap: 10px; }

    /* Toggle Theme */
    .toggle {
      display: inline-flex; align-items: center; gap: 8px; font-size: 14px; color: var(--muted);
      user-select: none;
    }
    .switch {
      position: relative; width: 48px; height: 26px; border-radius: 999px;
      background: var(--panel-2); border: 1px solid var(--border); cursor: pointer;
      transition: background .2s ease;
    }
    .switch::after {
      content: ""; position: absolute; top: 50%; left: 3px; transform: translateY(-50%);
      width: 20px; height: 20px; border-radius: 50%; background: var(--accent);
      transition: left .2s ease;
    }
    [data-theme="light"] .switch::after { left: 25px; }

    /* ---------- Topbar (URL/Method/Send) ---------- */
    .topbar {
      display: grid;
      gap: 10px;
      grid-template-columns: 130px 1fr 120px;
      padding: 14px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.03), transparent);
    }
    @media (max-width: 820px) {
      .topbar { grid-template-columns: 1fr; }
    }

    .select, .input, .button {
      width: 100%;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--input-bg);
      color: var(--text);
      padding: 10px 12px;
      font-size: 14px;
      outline: none;
      transition: border-color .2s ease, box-shadow .2s ease, transform .04s ease;
    }
    .select:focus, .input:focus, textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(59,130,246,.2);
    }

    .button {
      display: inline-flex; align-items: center; justify-content: center; gap: 10px;
      font-weight: 600; cursor: pointer; background: linear-gradient(180deg, var(--accent), var(--accent-2));
      border: none;
      box-shadow: 0 8px 20px rgba(37,99,235,.35);
    }
    .button:active { transform: translateY(1px); }
    .button[disabled] { opacity: .7; cursor: not-allowed; }

    /* ---------- Grid Principal (Request | Response) ---------- */
    .main {
      display: grid; gap: 16px; padding: 16px;
      grid-template-columns: 1fr 1fr;
    }
    @media (max-width: 1000px) {
      .main { grid-template-columns: 1fr; }
    }
.logo {
  font-weight: bold;
  font-size: 1.3rem;
}

.logo span {
  font-weight: normal;
  font-size: 1rem;
  margin-left: 5px;
  color: #aaa;
}

.brand {
  font-weight: bold;
  font-size: 1.2rem;
}

.brand .ai {
  color: #6587f7;
}
    .panel {
      border: 1px solid var(--border);
      border-radius: 12px;
      background: var(--panel);
      overflow: hidden;
    }
    .panel-header {
      display: flex; align-items: center; justify-content: space-between; gap: 12px;
      padding: 10px 12px; border-bottom: 1px solid var(--border); background: linear-gradient(180deg, rgba(255,255,255,.03), transparent);
      font-weight: 600;
    }
    .hint { font-size: 12px; color: var(--muted); font-weight: 500; }

    .toolbar {
      display: flex; align-items: center; gap: 8px;
    }
    .mini-btn {
      border: 1px solid var(--border);
      background: var(--panel-2);
      color: var(--text);
      padding: 6px 10px;
      border-radius: 10px;
      font-size: 12px;
      cursor: pointer;
    }
    .mini-btn:hover { border-color: var(--accent); }

    textarea {
      width: 100%; min-height: 260px; resize: vertical;
      border: none; outline: none; padding: 12px; font-size: 13.5px;
      background: transparent; color: var(--code); font-family: var(--mono);
    }
    .readonly { background: transparent; color: var(--code); }

    .meta {
      display: flex; gap: 10px; align-items: center; flex-wrap: wrap;
      padding: 10px 12px; font-size: 12px; color: var(--muted); border-top: 1px solid var(--border);
      background: linear-gradient(0deg, rgba(255,255,255,.02), transparent);
    }
    .badge { padding: 4px 8px; border-radius: 999px; border: 1px solid var(--border); background: var(--panel-2); color: var(--text); }
    .status-2xx { border-color: rgba(34,197,94,.35); color: var(--good); }
    .status-4xx, .status-5xx { border-color: rgba(239,68,68,.35); color: var(--bad); }

    /* ---------- Loader Overlay ---------- */
    .overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,.35);
      display: none; align-items: center; justify-content: center; z-index: 50;
      backdrop-filter: blur(1px);
    }
    .overlay.show { display: flex; }
    .spinner {
      width: 36px; height: 36px; border-radius: 50%;
      border: 3px solid rgba(255,255,255,.25);
      border-top-color: var(--accent);
      animation: spin 1s linear infinite;
      margin: 0 auto 8px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .overlay-card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 16px 18px;
      box-shadow: var(--shadow);
      text-align: center;
      color: var(--muted);
      min-width: 220px;
    }

    .footer-note {
      margin-top: 14px; color: var(--muted); font-size: 12px; text-align: right;
      padding: 0 4px 6px;
    }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <!-- Header -->
      <div class="header">
        <div class="brand">
          <span class="dot"></span>
          <header>
      
      <div class="logo"></div>
      
    </header>
          <span>FOUNDERS<span class="ai">AI</span> Webhook Tester</span>
        </div>
        <div class="header-actions">
          <div class="toggle" title="Alternar tema">
            <span id="themeLabel">Dark</span>
            <div class="switch" id="themeSwitch" role="switch" aria-checked="true" tabindex="0"></div>
          </div>
        </div>
      </div>

      <!-- Topbar -->
      <div class="topbar">
        <select id="method" class="select" aria-label="Método HTTP">
          <option value="GET">GET</option>
          <option value="POST">POST</option>
        </select>

        <input id="url" class="input" type="url" placeholder="https://api.exemplo.com/recurso" aria-label="URL" />

        <button id="sendBtn" class="button" title="Enviar (Ctrl+Enter)">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"/>
          </svg>
          Enviar
        </button>
      </div>

      <!-- Main -->
      <div class="main">
        <!-- Request -->
        <section class="panel" aria-labelledby="reqTitle">
          <div class="panel-header">
            <div>
              <div id="reqTitle">Request Body</div>
              <div class="hint">Padrão: <code>application/json</code>. Visível apenas para <b>POST</b>.</div>
            </div>
            <div class="toolbar">
              <button class="mini-btn" id="beautifyReq" title="Formatar JSON">Beautify</button>
              <button class="mini-btn" id="copyReq" title="Copiar corpo da requisição">Copiar</button>
              <span class="hint" id="reqBytes">0 bytes</span>
            </div>
          </div>
          <textarea id="body" placeholder='Ex.: { "nome": "Ada", "ativo": true }' aria-label="Corpo da requisição (JSON)"></textarea>
        </section>

        <!-- Response -->
        <section class="panel" aria-labelledby="resTitle">
          <div class="panel-header">
            <div>
              <div id="resTitle">Response</div>
              <div class="hint">Somente leitura</div>
            </div>
            <div class="toolbar">
              <button class="mini-btn" id="beautifyRes" title="Formatar JSON">Beautify</button>
              <button class="mini-btn" id="copyRes" title="Copiar resposta">Copiar</button>
            </div>
          </div>
          <textarea id="response" class="readonly" readonly placeholder="A resposta aparecerá aqui..."></textarea>
          <div class="meta">
            <span class="badge" id="statusBadge">Status: —</span>
            <span class="badge" id="timeBadge">Tempo: —</span>
            <span class="badge" id="sizeBadge">Tamanho: —</span>
            <span class="hint">Headers padronizados: <code>Accept: application/json</code> (sempre) e <code>Content-Type: application/json</code> (apenas POST).</span>
          </div>
        </section>
      </div>

      <div class="footer-note">
        Dica: para evitar erros de <em>CORS</em>, o servidor-alvo deve permitir requisições do seu domínio/origem.
      </div>
    </div>
  </div>

  <!-- Loader -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="overlay-card">
      <div class="spinner" aria-label="Carregando"></div>
      <div>Enviando requisição…</div>
    </div>
  </div>

  <script>
    // ---------- Elementos ----------
    const methodEl = document.getElementById('method');
    const urlEl = document.getElementById('url');
    const bodyEl = document.getElementById('body');
    const sendBtn = document.getElementById('sendBtn');
    const resEl = document.getElementById('response');
    const statusBadge = document.getElementById('statusBadge');
    const timeBadge = document.getElementById('timeBadge');
    const sizeBadge = document.getElementById('sizeBadge');
    const overlay = document.getElementById('overlay');
    const beautifyReq = document.getElementById('beautifyReq');
    const beautifyRes = document.getElementById('beautifyRes');
    const copyReq = document.getElementById('copyReq');
    const copyRes = document.getElementById('copyRes');
    const reqBytes = document.getElementById('reqBytes');
    const themeSwitch = document.getElementById('themeSwitch');
    const themeLabel = document.getElementById('themeLabel');

    // ---------- Tema ----------
    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      themeLabel.textContent = theme === 'light' ? 'Light' : 'Dark';
      localStorage.setItem('mini-rest-theme', theme);
    }
    const preferred = localStorage.getItem('mini-rest-theme') ||
      (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    setTheme(preferred);

    function toggleTheme() {
      const now = document.documentElement.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
      setTheme(now);
    }
    themeSwitch.addEventListener('click', toggleTheme);
    themeSwitch.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleTheme(); } });

    // ---------- UI Helpers ----------
    function setLoading(on) {
      overlay.classList.toggle('show', on);
      overlay.setAttribute('aria-hidden', String(!on));
      sendBtn.disabled = on;
    }
    function bytesOf(str) {
      return new Blob([str || ""]).size;
    }
    function updateReqBytes() {
      reqBytes.textContent = bytesOf(bodyEl.value) + ' bytes';
    }
    bodyEl.addEventListener('input', updateReqBytes);
    updateReqBytes();

    function showStatus(status) {
      statusBadge.textContent = 'Status: ' + status;
      statusBadge.classList.remove('status-2xx','status-4xx','status-5xx');
      if (status >= 200 && status < 300) statusBadge.classList.add('status-2xx');
      else if (status >= 400 && status < 500) statusBadge.classList.add('status-4xx');
      else if (status >= 500) statusBadge.classList.add('status-5xx');
    }

    function prettyTry(text) {
      try { return JSON.stringify(JSON.parse(text), null, 2); }
      catch { return text; }
    }

    // Esconde/mostra corpo conforme método
    function syncBodyVisibility() {
      const isPost = methodEl.value === 'POST';
      bodyEl.parentElement.style.display = isPost ? 'block' : 'none';
    }
    methodEl.addEventListener('change', syncBodyVisibility);
    syncBodyVisibility();

    // ---------- Copiar / Beautify ----------
    copyReq.addEventListener('click', async () => {
      await navigator.clipboard.writeText(bodyEl.value);
      copyReq.textContent = 'Copiado!';
      setTimeout(() => copyReq.textContent = 'Copiar', 900);
    });
    copyRes.addEventListener('click', async () => {
      await navigator.clipboard.writeText(resEl.value);
      copyRes.textContent = 'Copiado!';
      setTimeout(() => copyRes.textContent = 'Copiar', 900);
    });
    beautifyReq.addEventListener('click', () => {
      if (!bodyEl.value.trim()) return;
      bodyEl.value = prettyTry(bodyEl.value);
      updateReqBytes();
    });
    beautifyRes.addEventListener('click', () => {
      if (!resEl.value.trim()) return;
      resEl.value = prettyTry(resEl.value);
    });

    // ---------- Enviar (Ctrl+Enter) ----------
    document.addEventListener('keydown', (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') sendBtn.click();
    });

    // ---------- Requisição ----------
    async function sendRequest() {
      const url = urlEl.value.trim();
      const method = methodEl.value;
      if (!/^https?:\/\//i.test(url)) {
        alert('Informe uma URL válida começando com http:// ou https://');
        return;
      }

      const headers = { 'Accept': 'application/json' };
      const options = { method, headers };

      // Por padrão, Content-Type: application/json no POST
      if (method === 'POST') {
        const raw = bodyEl.value.trim();
        if (!raw) {
          // corpo vazio ainda é JSON válido
          options.body = '{}';
        } else {
          try {
            const parsed = JSON.parse(raw);
            options.body = JSON.stringify(parsed);
          } catch (err) {
            alert('O corpo da requisição não é um JSON válido.\nDetalhes: ' + err.message);
            return;
          }
        }
        headers['Content-Type'] = 'application/json';
      }

      resEl.value = '';
      showStatus('—');
      timeBadge.textContent = 'Tempo: —';
      sizeBadge.textContent = 'Tamanho: —';

      const t0 = performance.now();
      setLoading(true);
      try {
        const resp = await fetch(url, options);
        const t1 = performance.now();
        const elapsed = Math.max(0, t1 - t0);
        timeBadge.textContent = 'Tempo: ' + elapsed.toFixed(0) + ' ms';
        showStatus(resp.status + ' ' + (resp.statusText || ''));

        const text = await resp.text();
        sizeBadge.textContent = 'Tamanho: ' + bytesOf(text) + ' bytes';

        // Tenta exibir formatado se for JSON
        const contentType = resp.headers.get('content-type') || '';
        if (contentType.includes('application/json')) {
          resEl.value = prettyTry(text);
        } else {
          // Ainda tenta parsear caso o servidor não informe corretamente
          resEl.value = prettyTry(text);
        }
      } catch (err) {
        setLoading(false);
        showStatus('Falha');
        resEl.value = 'Erro ao enviar a requisição.\n' + (err?.message || String(err));
        return;
      } finally {
        setLoading(false);
      }
    }

    sendBtn.addEventListener('click', sendRequest);
  </script>
</body>
</html>
